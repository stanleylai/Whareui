/*
 * Sidr
 * https://github.com/artberri/sidr
 *
 * Copyright (c) 2013 Alberto Varela
 * Licensed under the MIT license.
 */(function(e){var t=!1,n=!1,r={isUrl:function(e){var t=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return t.test(e)?!0:!1},loadContent:function(e,t){e.html(t)},addPrefix:function(e){var t=e.attr("id"),n=e.attr("class");typeof t=="string"&&""!==t&&e.attr("id",t.replace(/([A-Za-z0-9_.\-]+)/g,"sidr-id-$1"));typeof n=="string"&&""!==n&&"sidr-inner"!==n&&e.attr("class",n.replace(/([A-Za-z0-9_.\-]+)/g,"sidr-class-$1"));e.removeAttr("style")},execute:function(r,s,o){if(typeof s=="function"){o=s;s="sidr"}else s||(s="sidr");var u=e("#"+s),a=e("#content"),f=e("#header"),l=e("html"),c=u.outerWidth(!0),h=u.data("speed"),p=u.data("side"),d,v,m;if("open"===r||"toogle"===r&&!u.is(":visible")){if(u.is(":visible")||t)return;if(n!==!1){i.close(n,function(){i.open(s)});return}t=!0;if(p==="left"){d={left:c+"px"};v={left:"0px"}}else{d={right:c+"px"};v={right:"0px"}}m=l.scrollTop();l.css("overflow-x","hidden").scrollTop(m);a.css({width:a.width(),position:"absolute"}).animate(d,h);f.css({width:a.width(),position:"absolute"}).animate(d,h);u.css("display","block").animate(v,h,function(){t=!1;n=s;typeof o=="function"&&o(s)})}else{if(!u.is(":visible")||t)return;t=!0;if(p==="left"){d={left:0};v={left:"-"+c+"px"}}else{d={right:0};v={right:"-"+c+"px"}}m=l.scrollTop();l.removeAttr("style").scrollTop(m);a.animate(d,h);f.animate(d,h);u.animate(v,h,function(){u.removeAttr("style");a.removeAttr("style");f.removeAttr("style");e("html").removeAttr("style");t=!1;n=!1;typeof o=="function"&&o(s)})}}},i={open:function(e,t){r.execute("open",e,t)},close:function(e,t){r.execute("close",e,t)},toogle:function(e,t){r.execute("toogle",e,t)}};e.sidr=function(t){if(i[t])return i[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="function"||typeof t=="string"||!t)return i.toogle.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.sidr")};e.fn.sidr=function(t){var n=e.extend({name:"sidr",speed:200,side:"left",source:null,renaming:!0,body:"body"},t),s=n.name,o=e("#"+s);o.length===0&&(o=e("<div />").attr("id",s).appendTo(e("body")));o.addClass("sidr").addClass(n.side).data({speed:n.speed,side:n.side,body:n.body});if(typeof n.source=="function"){var u=n.source(s);r.loadContent(o,u)}else if(typeof n.source=="string"&&r.isUrl(n.source))e.get(n.source,function(e){r.loadContent(o,e)});else if(typeof n.source=="string"){var a="",f=n.source.split(",");e.each(f,function(t,n){a+='<div class="sidr-inner">'+e(n).html()+"</div>"});if(n.renaming){var l=e("<div />").html(a);l.find("*").each(function(t,n){var i=e(n);r.addPrefix(i)});a=l.html()}r.loadContent(o,a)}else n.source!==null&&e.error("Invalid Sidr Source");return this.each(function(){var t=e(this),n=t.data("sidr");if(!n){t.data("sidr",s);t.click(function(e){e.preventDefault();i.toogle(s)})}})}})(jQuery);